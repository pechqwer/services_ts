{"version":3,"file":"req_api.js","sourceRoot":"","sources":["../../src/config/req_api.ts"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nimport axios, { AxiosRequestConfig, AxiosResponse } from 'axios';\nimport axiosRetry from 'axios-retry';\n\n\nconst client = axios.create({\n  timeout: 30000,\n})\naxiosRetry(client, {\n  retries: 3,\n  shouldResetTimeout: true,\n  retryCondition: (_error) => true,\n  retryDelay: (retryCount) => {\n    return retryCount * (Number(100) || 0); // milisecond\n  }\n});\n\nfunction successHandler(result: AxiosResponse<any, any>) {\n  return {\n    success: true,\n    res: (result.data ? result.data : null),\n    headers: result.headers,\n    status: result.status,\n  };\n}\n\nfunction errorHandler(e: { response: { status: any; body: any; data: any; headers: any; }; message: any; }) {\n  if (e.response) {\n    return {\n      success: false,\n      status: e.response.status,\n      res: e.response.body ? e.response.body : (e.response.data ? e.response.data : null),\n      err: e.message,\n      headers: e.response.headers ? e.response.headers : null,\n    };\n  } else {\n    return {\n      success: false,\n      status: 999,\n      res: null,\n      err: e.message,\n      headers: null,\n    };\n  }\n}\n\nconst req_api = {\n  get: async (url: string, option?: AxiosRequestConfig<any> | undefined) => {\n    // console.info('## config.reqApi.get')\n    return new Promise(async (resolve, rejects) => {\n      let timeStart: any = new Date();\n      let result: AxiosResponse<any, any>\n      try {\n        if (!url) return false;\n        result = await client.get(url, option);\n        let timeEnd: Number = new Date() as any - timeStart;\n        console.info(`GET Request url: ${url} - time: ${timeEnd} ms`);\n        return resolve(successHandler(result))\n      } catch (e) {\n        if ([400,401,403].includes(e.status)) {\n          console.error('### Error config.reqApi.get:', e.message, e.status);\n          return resolve(errorHandler(e))\n        }\n        console.error('### Error config.reqApi.get:', e);\n        return resolve(errorHandler(e))\n      }\n    })\n\n\n  },\n  post: async (url: string, body: any, option?: AxiosRequestConfig<any> | undefined) => {\n    // console.info('## config.reqApi.post');\n    let timeStart: any = new Date();\n    let result: AxiosResponse<any, any>\n    try {\n      result = await client.post(url, body, option);\n      let timeEnd: Number = new Date() as any - timeStart;\n      console.info(`POST Request url: ${url} - time: ${timeEnd} ms`);\n      return successHandler(result);\n    } catch (e) {\n      if ([400,401,403].includes(e.status)) {\n        console.error('### Error config.reqApi.post:', e.message, e.status);\n        return errorHandler(e)\n      }\n      console.error('### Error config.reqApi.post:', e);\n      return errorHandler(e)\n    }\n  },\n  put: async (url: string, body: any, option?: AxiosRequestConfig<any> | undefined) => {\n    // console.info('## config.reqApi.put')\n    let timeStart: any = new Date();\n    let result: AxiosResponse<any, any>\n    try {\n      result = await client.put(url, body, option);\n      let timeEnd: Number = new Date() as any - timeStart;\n      console.info(`PUT Request url: ${url} - time: ${timeEnd} ms`);\n      return successHandler(result);\n    } catch (e) {\n      if ([400,401,403].includes(e.status)) {\n        console.error('### Error config.reqApi.post:', e.message, e.status);\n        return errorHandler(e)\n      }\n      console.error('### Error config.reqApi.put:', e);\n      return errorHandler(e)\n    }\n  },\n  delete: async (url: string, option: AxiosRequestConfig<any> | undefined) => {\n    console.info('## config.reqApi.delete')\n    let timeStart: any = new Date();\n    let result: AxiosResponse<any, any>\n    try {\n      result = await client.delete(url, option);\n      let timeEnd: Number = new Date() as any - timeStart;\n      console.info(`DELETE Request url: ${url} - time: ${timeEnd} ms`);\n      return successHandler(result);\n    } catch (e) {\n      if ([400,401,403].includes(e.status)) {\n        console.error('### Error config.reqApi.post:', e.message, e.status);\n        return errorHandler(e)\n      }\n      console.error('### Error config.reqApi.delete:', e);\n      return errorHandler(e);\n    }\n  },\n};\n\n\nexport default req_api\n"]}